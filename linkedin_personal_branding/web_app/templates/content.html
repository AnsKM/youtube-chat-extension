{% extends "base.html" %}

{% block title %}Content Planning - LinkedIn Personal Branding{% endblock %}

{% block header %}Content Planning{% endblock %}
{% block subtitle %}Plan, create, and schedule your AI expertise content{% endblock %}

{% block content %}
<!-- Content Overview Cards -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="metric-card">
        <div class="flex items-center justify-between mb-2">
            <h3 class="text-sm font-medium text-gray-600">Ideas Bank</h3>
            <i class="fas fa-lightbulb text-accent"></i>
        </div>
        <div class="text-2xl font-bold text-gray-900">{{ ideas|length }}</div>
        <div class="text-sm text-gray-500">Ready to use</div>
    </div>
    
    <div class="metric-card">
        <div class="flex items-center justify-between mb-2">
            <h3 class="text-sm font-medium text-gray-600">This Week</h3>
            <i class="fas fa-calendar text-primary"></i>
        </div>
        <div class="text-2xl font-bold text-gray-900">{{ calendar|selectattr('status', 'equalto', 'planned')|list|length }}</div>
        <div class="text-sm text-gray-500">Posts scheduled</div>
    </div>
    
    <div class="metric-card">
        <div class="flex items-center justify-between mb-2">
            <h3 class="text-sm font-medium text-gray-600">Drafts</h3>
            <i class="fas fa-edit text-secondary"></i>
        </div>
        <div class="text-2xl font-bold text-gray-900">{{ calendar|selectattr('status', 'equalto', 'draft')|list|length }}</div>
        <div class="text-sm text-gray-500">In progress</div>
    </div>
    
    <div class="metric-card">
        <div class="flex items-center justify-between mb-2">
            <h3 class="text-sm font-medium text-gray-600">Avg. Engagement</h3>
            <i class="fas fa-chart-line text-primary"></i>
        </div>
        <div class="text-2xl font-bold text-gray-900">{{ performance.avg_engagement }}%</div>
        <div class="text-sm text-gray-500">Last 30 days</div>
    </div>
</div>

<!-- Main Content Grid -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    
    <!-- Content Ideas -->
    <div class="lg:col-span-2 space-y-6">
        
        <!-- Quick Content Generator -->
        <div class="card">
            <h3 class="text-lg font-semibold mb-4">AI Content Generator</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Topic</label>
                    <input type="text" id="contentTopic" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="e.g., AI automation, Claude Code, business processes">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Content Type</label>
                        <select id="contentType" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                            <option value="educational">Educational Post</option>
                            <option value="case_study">Case Study</option>
                            <option value="personal">Personal Story</option>
                            <option value="carousel">Carousel Post</option>
                            <option value="poll">Poll/Question</option>
                            <option value="industry_news">Industry News</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Tone</label>
                        <select id="contentTone" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                            <option value="professional">Professional</option>
                            <option value="conversational">Conversational</option>
                            <option value="inspiring">Inspiring</option>
                            <option value="educational">Educational</option>
                        </select>
                    </div>
                </div>
                <button onclick="generateContent()" class="btn-primary w-full">
                    <i class="fas fa-magic mr-2"></i>
                    Generate Content Ideas
                </button>
            </div>
        </div>
        
        <!-- Content Ideas Bank -->
        <div class="card">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Content Ideas Bank</h3>
                <button onclick="addCustomIdea()" class="btn-secondary text-sm">
                    <i class="fas fa-plus mr-1"></i>
                    Add Idea
                </button>
            </div>
            
            <div class="space-y-3">
                {% for idea in ideas %}
                <div class="flex items-center justify-between p-3 border border-gray-100 rounded-lg hover:bg-gray-50">
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">{{ idea.idea }}</p>
                        <div class="flex items-center mt-1 space-x-2">
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                                       {% if idea.category == 'personal' %}bg-blue-100 text-blue-800
                                       {% elif idea.category == 'educational' %}bg-green-100 text-green-800
                                       {% elif idea.category == 'case_study' %}bg-purple-100 text-purple-800
                                       {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ idea.category|replace('_', ' ')|title }}
                            </span>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                                       {% if idea.urgency == 'high' %}bg-red-100 text-red-800
                                       {% elif idea.urgency == 'medium' %}bg-yellow-100 text-yellow-800
                                       {% else %}bg-green-100 text-green-800{% endif %}">
                                {{ idea.urgency|title }}
                            </span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="useIdea('{{ idea.idea }}')" class="btn-primary text-xs">
                            Use
                        </button>
                        <button onclick="deleteIdea('{{ loop.index0 }}')" class="text-red-600 hover:text-red-800 text-xs">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                {% endfor %}
                
                {% if not ideas %}
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-lightbulb text-2xl mb-2"></i>
                    <p>No content ideas yet</p>
                    <p class="text-sm">Generate some ideas to get started!</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Content Calendar -->
    <div class="lg:col-span-1">
        <div class="card">
            <h3 class="text-lg font-semibold mb-4">Content Calendar</h3>
            
            <!-- Calendar Navigation -->
            <div class="flex items-center justify-between mb-4">
                <button onclick="previousWeek()" class="p-1 text-gray-600 hover:text-gray-800">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span class="font-medium">This Week</span>
                <button onclick="nextWeek()" class="p-1 text-gray-600 hover:text-gray-800">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <!-- Calendar Items -->
            <div class="space-y-3">
                {% for item in calendar %}
                <div class="p-3 border border-gray-100 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-xs font-medium text-gray-600">{{ item.date }}</span>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                                   {% if item.status == 'planned' %}bg-green-100 text-green-800
                                   {% elif item.status == 'draft' %}bg-yellow-100 text-yellow-800
                                   {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {{ item.status|title }}
                        </span>
                    </div>
                    <p class="text-sm text-gray-900">{{ item.topic }}</p>
                    <div class="flex space-x-2 mt-2">
                        <button onclick="editPost('{{ loop.index0 }}')" class="text-blue-600 hover:text-blue-800 text-xs">
                            Edit
                        </button>
                        <button onclick="deletePost('{{ loop.index0 }}')" class="text-red-600 hover:text-red-800 text-xs">
                            Delete
                        </button>
                    </div>
                </div>
                {% endfor %}
                
                {% if not calendar %}
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-calendar text-2xl mb-2"></i>
                    <p>No posts scheduled</p>
                    <p class="text-sm">Plan your content for the week!</p>
                </div>
                {% endif %}
            </div>
            
            <button onclick="addToCalendar()" class="w-full mt-4 btn-secondary text-sm">
                <i class="fas fa-plus mr-2"></i>
                Schedule Post
            </button>
        </div>
    </div>
</div>

<!-- Content Templates -->
<div class="mt-8">
    <div class="card">
        <h3 class="text-lg font-semibold mb-4">Content Templates</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('transformation')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-rocket text-primary mr-2"></i>
                    <h4 class="font-medium">Transformation Story</h4>
                </div>
                <p class="text-sm text-gray-600">Share your journey from [old role] to AI expert</p>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('tips')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-list text-secondary mr-2"></i>
                    <h4 class="font-medium">5 Tips Format</h4>
                </div>
                <p class="text-sm text-gray-600">Educational list format for AI tips and best practices</p>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('case_study')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-chart-bar text-accent mr-2"></i>
                    <h4 class="font-medium">Case Study</h4>
                </div>
                <p class="text-sm text-gray-600">Before/after results from AI implementation</p>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('industry_insight')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-eye text-primary mr-2"></i>
                    <h4 class="font-medium">Industry Insight</h4>
                </div>
                <p class="text-sm text-gray-600">Commentary on AI trends and industry news</p>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('poll')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-poll text-secondary mr-2"></i>
                    <h4 class="font-medium">Engagement Poll</h4>
                </div>
                <p class="text-sm text-gray-600">Question to engage your audience about AI topics</p>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="useTemplate('carousel')">
                <div class="flex items-center mb-2">
                    <i class="fas fa-images text-accent mr-2"></i>
                    <h4 class="font-medium">Carousel Post</h4>
                </div>
                <p class="text-sm text-gray-600">Multi-slide educational content format</p>
            </div>
        </div>
    </div>
</div>

<!-- Generated Content Modal -->
<div id="contentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center h-full p-4">
        <div class="bg-white rounded-lg w-full max-w-4xl max-h-96 overflow-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold" id="modalTitle">Generated Content</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="modalContent" class="text-sm text-gray-700 whitespace-pre-wrap"></div>
                <div class="mt-4 flex justify-end space-x-3">
                    <button onclick="closeModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800">
                        Close
                    </button>
                    <button onclick="saveToIdeas()" class="btn-secondary">
                        Save to Ideas
                    </button>
                    <button onclick="copyModalContent()" class="btn-primary">
                        Copy Content
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Content generation
function generateContent() {
    const topic = document.getElementById('contentTopic').value;
    const type = document.getElementById('contentType').value;
    const tone = document.getElementById('contentTone').value;
    
    if (!topic) {
        alert('Please enter a topic');
        return;
    }
    
    showModal('Generating Content...', 'Creating AI-powered content ideas...');
    
    fetch('/api/content-ideas', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            topic: topic,
            type: type,
            tone: tone
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const content = data.ideas.join('\n\n');
            showModal('Generated Content Ideas', content);
        } else {
            alert('Error generating content: ' + data.error);
            closeModal();
        }
    });
}

// Template functions
function useTemplate(templateType) {
    const templates = {
        transformation: `🚀 My transformation story:

From [Previous Role] to AI Solutions Architect

3 key lessons I learned:

1) [Lesson 1]
2) [Lesson 2] 
3) [Lesson 3]

The biggest challenge? [Challenge]
The breakthrough moment? [Breakthrough]

What would you do differently on your AI journey?

#AI #Transformation #LinkedInLearning`,
        
        tips: `5 AI implementation tips I wish I knew earlier:

1) Start small and scale
   [Explanation]

2) Focus on ROI, not tech
   [Explanation]

3) Involve your team early
   [Explanation]

4) Measure everything
   [Explanation]

5) Plan for change management
   [Explanation]

Which tip resonates most with your experience?

#AI #BusinessTips #Automation`,
        
        case_study: `Real Results: [Client/Project Name] AI Implementation

BEFORE:
• [Problem 1]
• [Problem 2]
• [Problem 3]

AFTER:
• [Result 1]
• [Result 2] 
• [Result 3]

KEY TAKEAWAY:
[Main lesson]

Timeline: [Duration]
Investment: [Cost/Effort]
ROI: [Return]

Questions about implementing AI in your business? Drop them below 👇

#AI #CaseStudy #BusinessResults`,
        
        industry_insight: `Hot take on [Industry Topic]:

[Your perspective/opinion]

Here's why this matters:
• [Point 1]
• [Point 2]
• [Point 3]

What most people miss:
[Key insight]

My prediction for 2025:
[Future outlook]

Agree or disagree? Share your thoughts! 👇

#AI #Industry #TechTrends`,
        
        poll: `Quick poll for AI enthusiasts:

What's your biggest AI implementation challenge?

A) Choosing the right tools
B) Team adoption and training  
C) Measuring ROI
D) Integration with existing systems

Drop your letter in the comments + why!

I'll share insights based on the results 📊

#AI #Poll #BusinessChallenges`,
        
        carousel: `Carousel Post: [Topic]

Slide 1: Title + Hook
[Attention-grabbing headline]

Slide 2: Problem
[What challenge are you addressing?]

Slide 3-5: Solutions/Steps
[3 key points or steps]

Slide 6: Results/Benefits
[What outcomes can they expect?]

Slide 7: Call to Action
[What do you want them to do next?]

#AI #Education #HowTo`
    };
    
    showModal(`${templateType.replace('_', ' ').toUpperCase()} Template`, templates[templateType]);
}

// Modal functions
function showModal(title, content) {
    document.getElementById('modalTitle').textContent = title;
    document.getElementById('modalContent').textContent = content;
    document.getElementById('contentModal').classList.remove('hidden');
}

function closeModal() {
    document.getElementById('contentModal').classList.add('hidden');
}

function copyModalContent() {
    const content = document.getElementById('modalContent').textContent;
    navigator.clipboard.writeText(content).then(() => {
        alert('Content copied to clipboard!');
    });
}

function saveToIdeas() {
    const content = document.getElementById('modalContent').textContent;
    // This would save to the ideas bank
    alert('Saved to ideas bank!');
    closeModal();
}

// Calendar functions
function addToCalendar() {
    const topic = prompt('Post topic:');
    const date = prompt('Date (YYYY-MM-DD):');
    if (topic && date) {
        // Save to calendar
        alert('Added to calendar!');
    }
}

function editPost(index) {
    alert('Edit post functionality - would open editor');
}

function deletePost(index) {
    if (confirm('Delete this scheduled post?')) {
        alert('Post deleted');
    }
}

// Ideas functions
function useIdea(idea) {
    showModal('Develop This Idea', `Original idea: ${idea}\n\nDevelop this into a full post...`);
}

function deleteIdea(index) {
    if (confirm('Delete this idea?')) {
        alert('Idea deleted');
    }
}

function addCustomIdea() {
    const idea = prompt('Enter your content idea:');
    if (idea) {
        alert('Idea added to bank!');
    }
}

// Navigation
function previousWeek() {
    alert('Previous week functionality');
}

function nextWeek() {
    alert('Next week functionality');
}
</script>
{% endblock %}